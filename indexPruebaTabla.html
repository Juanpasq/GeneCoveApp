<!DOCTYPE html>
<html>

<head>

    <script defer src="https://use.fontawesome.com/releases/v5.0.9/js/all.js" integrity="sha384-8iPTk2s/jMVj81dnzb/iFR2sdA7u06vHJyyLlAd4snFpCl/SnyUjRrbdJsw1pGIl" crossorigin="anonymous"></script>

    <!-- JQuery 3.1 -->
    <script src="http://code.jquery.com/jquery-3.3.1.js" integrity="sha256-2Kok7MbOyxpgUVvAk/HJ2jigOSYS2auK4Pfzbm7uH60=" crossorigin="anonymous"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

    <!-- Optional theme -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

    <script type="text/javascript" src="jscript.js"></script>

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/css/bootstrap-select.min.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.12.4/js/bootstrap-select.min.js"></script>

    <!-- spinner loader -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <script src="https://cdn.datatables.net/1.10.19/js/jquery.dataTables.min.js"></script>
    <link rel="stylesheet" href="https://cdn.datatables.net/1.10.19/css/dataTables.bootstrap.min.css" />


    <style>
        body {
            font-family: 'Hind Madurai', sans-serif;
            font-size: 16px;
        }

        p {
            font-size: .9em;
            text-align: justify;

        }

        caption{
            margin-left:0.5em;          
            font-size: 1.2em;
        }

        /**tabla de datos procesados**/
        
        thead{
            background-color:#181515;
            color: #D4D4D4;
        }

        table {

            width: 500px;
            margin: 0 auto;
            font-size: 0.85em;
            text-align: center;
            align-content: center;
            align-items: center;
        }

        th {
            margin: 0 auto;
        }

        td {

            text-align: justify;
            max-width: 300px;
            overflow: hidden;
            white-space: nowrap;
        }

        td:hover {
            overflow-x: visible;
        }

        /*+++loader css++++++*/

        .loader {

            border: 10px solid #181515;
            border-radius: 50%;
            border-top: 10px solid #2DA14D;
            width: 50px;
            height: 50px;
            margin: auto;
            z-index: auto;
            text-align: center;
            -webkit-animation: spin 1.5s linear infinite;
            /* Safari */
            animation: spin 1.5s linear infinite;
        }

        /* Safari */

        @-webkit-keyframes spin {
            0% {
                -webkit-transform: rotate(0deg);
            }
            100% {
                -webkit-transform: rotate(360deg);
            }
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }
            100% {
                transform: rotate(360deg);
            }
        }

        /* The Modal (background) */

        .modal {
            margin: auto;
            /* display: ;*/
            /* Hidden by default */
            z-index: 3;
            /* Sit on top */
            padding-top: 100px;
            /* Location of the box */
            left: 0;
            top: 0;
            width: 100%;
            /* Full width */
            height: 100%;
            /* Full height */
            overflow: auto;
            /* Enable scroll if needed */
            background-color: rgb(0, 0, 0);
            /* Fallback color */
            background-color: rgba(0, 0, 0, 0.6);
            /* Black w/ opacity */
        }

        /* Modal Content */

        .modal-content {
            background-color: transparent;
            margin: auto;
            padding: 20px;
            text-align: center;
            width: 80%;
        }

        table tr th {
            cursor: pointer;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        .sorting {
            background-color: #D4D4D4;
        }

        .asc:after {
            content: ' ↑';
        }

        .desc:after {
            content: " ↓";
        }

    </style>

</head>

<body>

    <!-- NavBar -->
    <nav class="navbar navbar-inverse" style="border-radius:0px;">
        <!-- Arreglo temporal: No se si corresponde modificar el el border radius del navbar desde aca o el estilo  -->
        <div class="container-fluid">
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
                <a class="navbar-brand" href="#">
                    <span style="font-family: 'Didact-Gothic', sans-serif;">GeneCovApp</span>
                </a>
            </div>
            <div class="collapse navbar-collapse" id="myNavbar" navbar-right>

                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="about.html">
                            <i class="fas fa-user-md"></i>&nbsp;&nbsp;About</a>
                    </li>
                    <li>
                        <a href="#">
                            <i class="fas fa-dna"></i>&nbsp;&nbsp;Gene</a>
                    </li>
                    <li>
                        <a href="#">
                            <i class="fas fa-code"></i>&nbsp;&nbsp;Code</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- contenido general-->
    <div class="container">


        <h1 id="home-title" style="font-size: 50px; text-align:center;">GeneCovApp</h1>
        <p class="text-muted" style="font-size: 24px; text-align:center;"> A simple webapp for a priori and a posteriori evaluation of experimental design in clinical NGS </p>

        <div padding class="form-group" style=" margin: 0 auto; padding:1em; max-width: 800px; text-align: center;">

            <!-- sector de input -->
            <div class="row">
                <div class="col-md-12">
                    <div class="input-group" id="adv-search">
                        <textarea rows="1" type="text" id="input-csv" class="form-control" placeholder="Search code" onkeyup="this.value = this.value.toUpperCase();" style="max-width:770px;"></textarea>
                        <span class="form-control-clear glyphicon glyphicon-remove form-control-feedback hidden"></span>
                        <!--boton upload file-->
                        <div class="input-group-btn">
                            <label data-toggle="tooltip" data-placement="right" title="Upload .csv file" class="btn" id="btn-csv" style="background-color: rgb(32, 32, 32); color: aliceblue;">
                                CSV&nbsp;
                                <i class="fas fa-upload"></i>
                                <input type="file" id="file-input" accept=".csv" style="display: none;">
                            </label>
                        </div>
                        <!--FIN boton upload file-->

                    </div>
                </div>
            </div>

            <p style="font-size:0.8em; margin: 0 auto;text-align: center;">Add a comma separated list of Genes.

                <span>* For example</span> : UBE3A =&gt; Coverage CDS:
                <span>0.824</span> ; Coverage CDSUTR:
                <span>0.431</span> ; Pathog. Var:
                <span>134</span>
            </p>
            <br>

            <div class="alert alert-danger alert-dismissible" style="display: none" id="alertGen">
                <a href="#" class="close" onclick="closeAlerGen()">&times;</a>
                <strong>Error.</strong> Please, insert Gene code symbol.
            </div>

            <!-- modulo de modal + spinner -->
            <div id="myModal" class="modal">

                <!-- Modal content + loader-->
                <div class="">
                    <div class="loader" id="loader" style="visibility:visible; margin-top:15%"></div>

                </div>

            </div>

            <script>
                // Get the modal
                var modal = document.getElementById('myModal');

            </script>
            <!--Fin de modulo spinner + modal -->

            <!-- sector multiple select-->
            <div class="row" id="adv-search">
                <div class="col-md-12">
                    <div class="input-group" id="btn-render">
                        <select id="selectKit" class="selectpicker" multiple title="Capture Kit" name="selectKit" data-actions-box="true" data-selected-text-format="count > 2" style=" text-align: center; margin: 0 auto;" data-width="55%" multiple data-max-options="20">
                            <!-- inserta dinamicamente option-->
                               
                        </select>

                        <!-- boton input BED file -->
                        <div class="input-group-btn">
                            <label data-toggle="tooltip" data-placement="right" title="Upload .bed file" class="btn" id="btn-bed" style="background-color: rgb(32, 32, 32); color:aliceblue">
                                BED&nbsp;
                                <i class="fas fa-upload"></i>
                                <input type="file" accept=".bed" style="display: none;" id="input-bed">
                            </label>
                        </div>

                    </div>
                </div>
            </div><br>

            <div class="alert alert-danger alert-dismissible" style="display: none" id="alertKit">
                <a href="#" class="close" onclick="closeAlerKit()" aria-label="close">&times;</a>
                <strong>Error.</strong> Please, select Kitname coverage.
            </div>

        </div>

        <!-- boton launch procesar -->
        <div padding class="row " style="margin: 0 auto;padding:1em; max-width:420px; text-align: justify;display: flex;
        justify-content: center;">
            <button id="btn-launch" onclick="url()" style="width: 200px; float: left; margin:0 auto;" class="btn btn-success  btn-block"><span class="glyphicon glyphicon-play"></span>&nbsp;&nbsp;Launch</button>
            <div disabled class="btn btn-secondary">&nbsp;</div>
            <button id="btn-clean" onclick="clean()" style=" width:200px; float: left; color: aliceblue; margin: 0 auto; background-color: rgb(32, 32, 32);" class="btn btn-secondary btn-dark"><span class="glyphicon glyphicon-refresh"></span>&nbsp;&nbsp;Clean</button>
        </div>

        <script>
            function sortTable() {
                var table, rows, switching, i, x, y, shouldSwitch;
                table = document.getElementById("table");
                switching = true;
                /*Make a loop that will continue until
                no switching has been done:*/
                while (switching) {
                    //start by saying: no switching is done:
                    switching = false;
                    rows = table.getElementsByTagName("TR");
                    /*Loop through all table rows (except the
                    first, which contains table headers):*/
                    for (i = 1; i < (rows.length - 1); i++) {
                        //start by saying there should be no switching:
                        shouldSwitch = false;
                        /*Get the two elements you want to compare,
                        one from current row and one from the next:*/
                        x = rows[i].getElementsByTagName("TD")[0];
                        y = rows[i + 1].getElementsByTagName("TD")[0];
                        //check if the two rows should switch place:
                        if (x.innerHTML.toLowerCase() > y.innerHTML.toLowerCase()) {
                            //if so, mark as a switch and break the loop:
                            shouldSwitch = true;
                            break;
                        }
                    }
                    if (shouldSwitch) {
                        /*If a switch has been marked, make the switch
                        and mark that a switch has been done:*/
                        rows[i].parentNode.insertBefore(rows[i + 1], rows[i]);
                        switching = true;
                    }
                }
            }

        </script>

        <script>
            ///funcion btn cancelar ////
            function clean() {

                document.getElementById("input-csv").value = "";
                location.reload();
            }

            ////armar array con los kit seleccionados//////      
            var array = [];

            $('#selectKit').change(function() {
                // Obtener valor del las opciones selecionadas
                var selectValue = $("#selectKit").val();
                //  $("#resultadoValue").text(selectValue);
                // ver como queda el array de seleccionados final/////
                //   console.log(selectValue);
                array = selectValue;
            });

            ////armardo de la url con el id kit seleccionado y los valores genes////// 
            function url() {


                //////validamos que no esten vacios los campos de ingreso////////
                var inpGen = document.getElementById("input-csv");
                var inpKit = document.getElementById("selectKit");

                if (inpGen.value == "") {

                    //    alert("Please insert Gene code");
                    var errorGen = document.getElementById("alertGen");
                    errorGen.style.display = "block";


                } else if (inpKit.value == "") {

                    //    alert("Please select Kitname coverage");
                    var errorKit = document.getElementById("alertKit");
                    errorKit.style.display = "block";

                } else {

                    //////ejecutamos accion para poner el modal + pantalla block + spinner///////
                    modal.style.display = "block";

                    ////////IP SERVER////////////////
                    var ipServer = "apps.bitgenia.com/genecovapp";

                    var kitsSeleccionados = array.toString();

                    //////traemos los valores de los genes introducidos en el input/////////
                    var csvValues3 = document.getElementById('input-csv').value;
                    csvValues3 = csvValues3.split(",");
                    csvValues3.sort();
                    csvValues2 = csvValues3.toString();
                    // console.log("CSV"+csvValues);
                    csvValues = csvValues2.replace(/\s/g, "");

                    //console.log("VALORES ORDENADOS:  " + csvValues.length)

                    ///prueba para ver como sale el url para procesar////
                    //console.log(csvValues+"  -- URL PRUEBA");


                    console.log("http://" + ipServer + "/getGeneStats/" + kitsSeleccionados + "/" + csvValues + "");
                    //window.open("http://"+ipServer+"/genecovapp/getGeneStats/" + kitsSeleccionados + "/" + csvValues + "");                  
                    //window.open("tabla.html");


                    /////armamos una variable para traer el archivo json/////
                    var urlProcesada = "http://" + ipServer + "/getGeneStats/" + kitsSeleccionados + "/" + csvValues + "";


                    ///buscamos las propiedades de los genes seleccionados en la url resultado///
                    $.getJSON(urlProcesada, function(genesjson) {


                        /*   console.log("entro >>> " + genesjson[0]["genes"][0].symbol);
                             console.log("longitud array KIT >>> " + genesjson.length);
                             console.log("longitud array GENES >>> " + genesjson[0]["genes"].length);*/

                        ////recorremos para buscar el KIT////
                        for (k = 0; k < genesjson.length; k++) {

                            //cantidad genes array seleccionado////
                            var cantidadGenes = genesjson[k]["genes"].length;

                            ////////titulo de la barra kitname en tabla////////
                            var kitname = genesjson[k].name + " (" + cantidadGenes + ")";
                            var texto = document.createTextNode(kitname);

                            ////xxxxxxxxxxxxx///     
                            var tablaGeneral = document.getElementById("contenedorTabla");
                            //tablaGeneral.className += "table-responsive";
                            var tabla = document.createElement("table");
                            tabla.className += "table table-striped";
                            
                            /////titulo del kit por tabla///////
                            var tituloTabla = document.createElement("caption");
                            tituloTabla.appendChild(texto);
                            tabla.appendChild(tituloTabla);

                            ////creamos todos los elementos/////////
                            var tr = document.createElement("tr");                          
                           
                            var th = document.createElement("th");
                            th.style.verticalAlign = "middle";
                            var th2 = document.createElement("th");
                            th2.style.verticalAlign = "middle";
                            var th3 = document.createElement("th");
                            th3.style.verticalAlign = "middle";
                            var th4 = document.createElement("th");
                            th4.style.verticalAlign = "middle";
                            var th5 = document.createElement("th");
                            th5.style.verticalAlign = "middle";
                            var th6 = document.createElement("th");
                            th6.style.verticalAlign = "middle";
                            var th7 = document.createElement("th");
                            th7.style.verticalAlign = "middle";
                            var th8 = document.createElement("th");
                            th8.style.verticalAlign = "middle";

                            //////creamos los textos contenidos de cada celda cabecera//////////
                            var texto1 = document.createTextNode("Symbol");
                            var texto2 = document.createTextNode("Coding Region Coverage");
                            var texto3 = document.createTextNode("Region Coverage UTR");
                            var texto4 = document.createTextNode("Pathogenic variants");
                            var texto5 = document.createTextNode("Covered Pathogenic variants");
                            var texto6 = document.createTextNode("Pathogenic variants not covered");
                            var texto7 = document.createTextNode("Detail Pathogenic variants not covered");
                            var texto8 = document.createTextNode("Synonyms");
                            
                            /////añadimos los textos//////
                            th.appendChild(texto1);
                            th2.appendChild(texto2);
                            th3.appendChild(texto3);
                            th4.appendChild(texto4);
                            th5.appendChild(texto5);
                            th6.appendChild(texto6);
                            th7.appendChild(texto7);
                            th8.appendChild(texto8);
                            
                            /////pegamos las celdas al row////
                            tr.appendChild(th);
                            tr.appendChild(th2);
                            tr.appendChild(th3);
                            tr.appendChild(th4);
                            tr.appendChild(th5);
                            tr.appendChild(th6);
                            tr.appendChild(th7);
                            tr.appendChild(th8);

                            var cabecera = document.createElement("thead");
               
                            cabecera.appendChild(tr);
                            cabecera.className +="thead-dark"
                            //cabecera.style.backgroundColor = "grey";
                       
                            tabla.appendChild(cabecera);

                            ///subrecorrido para encontrar los genes dentro de ese kit de cover//////
                            // console.log("GENES DENTRO DEL KIT :  " + genesjson[k]["genes"].length);

                            for (g = 0; g < genesjson[k]["genes"].length; g++) {


                                // console.log(genesjson[k]["genes"][g].symbol);
                                var symbol = genesjson[k]["genes"][g].symbol;

                                //    console.log(genesjson[k]["genes"][g].coverageCDS);
                                var coverageCDS = genesjson[k]["genes"][g].coverageCDS;
                                coverageCDS = (coverageCDS * 100).toFixed(1) + "%";

                                //  console.log(genesjson[k]["genes"][g].coverageCDSUTR);
                                var coverageCDSUTR = genesjson[k]["genes"][g].coverageCDSUTR;
                                coverageCDSUTR = (coverageCDSUTR * 100).toFixed(1) + "%";

                                //        console.log(genesjson[k]["genes"][g].pathogenicVariants);
                                var pathogenicVariants = genesjson[k]["genes"][g].pathogenicVariants;

                                //      console.log(genesjson[k]["genes"][g].pathogenicVariantsCover);
                                var pathogenicVariantsCover = genesjson[k]["genes"][g].pathogenicVariantsCover;

                                /////columna agregada diferencia entre patg cubiertos y no cubiertos (no json)////
                                var diferenciaPatog = (pathogenicVariants - pathogenicVariantsCover);

                                //    console.log(genesjson[k]["genes"][g].variantNotCovered);
                                var variantNotCovered2 = genesjson[k]["genes"][g].variantNotCovered;
                                ///validamos que si es null que dibuje cero///
                                if (variantNotCovered2 == "") {
                                    var variantNotCovered = 0;
                                } else {
                                    var variantNotCovered = variantNotCovered2
                                };

                                //        console.log(genesjson[k]["genes"][g].synonyms);
                                var synonyms = genesjson[k]["genes"][g].synonyms;

                                /////////traemos la tabla y creamos las celdas//////////
                                // var tabla = document.getElementById("contenidoTabla");

                                //una fila//
                                var fila = document.createElement("tr")

                                //por cada celda una col (cada th hay un td) = 8//
                                var row = document.createElement("th");
                                var row2 = document.createElement("th");
                                var row3 = document.createElement("th");
                                var row4 = document.createElement("th");
                                var row5 = document.createElement("th");
                                var row6 = document.createElement("th");
                                var row7 = document.createElement("th");
                                var row8 = document.createElement("th");

                                var celda1 = document.createElement("td");
                                var celda2 = document.createElement("td");
                                var celda3 = document.createElement("td");
                                var celda4 = document.createElement("td");
                                var celda5 = document.createElement("td");
                                var celda6 = document.createElement("td");
                                var celda7 = document.createElement("td");
                                var celda8 = document.createElement("td");

                                //textos de las 7 celdas//
                                var texto1 = document.createTextNode(symbol);
                                var texto2 = document.createTextNode(coverageCDS);
                                var texto3 = document.createTextNode(coverageCDSUTR);
                                var texto4 = document.createTextNode(pathogenicVariants);
                                var texto5 = document.createTextNode(pathogenicVariantsCover);
                                var texto6 = document.createTextNode(diferenciaPatog);
                                var texto7 = document.createTextNode(variantNotCovered);
                                var texto8 = document.createTextNode(synonyms);

                                //pegamos los componentes a sus padres//
                                celda1.appendChild(texto1);
                                celda2.appendChild(texto2);
                                celda3.appendChild(texto3);
                                celda4.appendChild(texto4);
                                celda5.appendChild(texto5);
                                celda6.appendChild(texto6);
                                celda7.appendChild(texto7);
                                celda8.appendChild(texto8);

                                row.appendChild(celda1);
                                row2.appendChild(celda2);
                                row3.appendChild(celda3);
                                row4.appendChild(celda4);
                                row5.appendChild(celda5);
                                row6.appendChild(celda6);
                                row7.appendChild(celda7);
                                row8.appendChild(celda8);

                                fila.appendChild(row);
                                fila.appendChild(row2);
                                fila.appendChild(row3);
                                fila.appendChild(row4);
                                fila.appendChild(row5);
                                fila.appendChild(row6);
                                fila.appendChild(row7);
                                fila.appendChild(row8);
   
                                var tbody = document.createElement("tbody");
                                tbody.setAttribute("id","contenidoTabla")

                                tbody.appendChild(fila);
                                tabla.appendChild(tbody);
                                tablaGeneral.appendChild(tabla);
                                tabla.setAttribute("id","table");

                                ///FIN traemos la tabla y creamos las celdas///

                                ///mostramos la tabla al finalizar la obtencion de datos///
                                var divTabla = document.getElementById("divTabla");
                                divTabla.style.display = "block";

                                //////// sacamos el spinner con el modal screen////////////
                                var modal = document.getElementById('myModal');
                                modal.style.display = "none";

                                ////////////cerramos los alert de los inpt/////////////////
                                var a = document.getElementById("alertGen");
                                a.style.display = "none";

                                var b = document.getElementById("alertKit");
                                b.style.display = "none";
                            }
                        }

                    });
                }
            }

        </script>

        <hr style="max-width: 770px;">

        <!-- sector about texto-->

        <div style="max-width: 900px; margin:0 auto;">
            <h4>About GeneCovAPP</h4>
            <p style="font-size:.9em; text-align: justify">The Genecovapp is a web application aimed to be a strong and trustable tool for aiding throughout the process of experimental design for Clinical NGS.</p>
            <p style="font-size:.9em; text-align: justify;">Along our experience in Clinical NGS in
                <a href="http://www.biargentina.com.ar/"> BIA </a>, we have identified the experimental design as the first and one of the most challenging pitfalls to overcome in order to get the expected results. Developing of a tool that could help in this critical step can improve not only the times needed for beginning with NGS experiments, but also to acquiring a bigger rate of succes.</p>
            <p style="font-size:.9em; text-align: justify;">GeneCovApp allows users to check the coverage of diferent available commercial enrichment kits (or even your own design, by uploading a BED file) for a list of Genes or variants, by generating an interactive complete report containing the data required for correctly evaluating wich options are the best. This web application also provides a service for evaluating those experiments already done, by uploading your own VCFs files, and assesing the quality of the experimental design and compare these results with the data obtained from the a priori analysis.</p>
            <p style="font-size:.9em; text-align: justify;">Check the github page for the project if you are interested in the code behind GeneCovApp
                <a href="https://github.com">here</a>.</p>
        </div>

        <hr style="max-width: 770px;">
        <p><button onclick="sortTable()">Sort</button></p>

        <div class="table-responsive" style="display:none" id="divTabla">
            <a onclick="exportTableToCSV('genecove.csv')" href="#" class="btn btn-success">
                <span class="glyphicon glyphicon-floppy-save"></span> Download to .csv file</a>
            <p></p>

        <div id="contenedorTabla" class="table-responsive">

        </div>

        <script>
            /////2 funciones para generar el csv y descarga////////////
            function downloadCSV(csv, filename) {
                var csvFile;
                var downloadLink;

                // CSV file
                csvFile = new Blob([csv], {
                    type: "text/csv"
                });

                // Download link
                downloadLink = document.createElement("a");

                // File name
                downloadLink.download = filename;

                // Create a link to the file
                downloadLink.href = window.URL.createObjectURL(csvFile);

                // Hide download link
                downloadLink.style.display = "none";

                // Add the link to DOM
                document.body.appendChild(downloadLink);

                // Click download link
                downloadLink.click();
            }

            function exportTableToCSV(filename) {
                var csv = [];
                var rows = document.querySelectorAll("table tr");

                for (var i = 0; i < rows.length; i++) {
                    var row = [],
                        cols = rows[i].querySelectorAll(" th");

                    for (var j = 0; j < cols.length; j++)
                        row.push(cols[j].innerText);

                    csv.push(row.join(","));
                }

                // Download CSV file
                downloadCSV(csv.join("\n"), filename);
            }
            //////fin de 2 funciones para csv//////////////////

        </script>

        <!--Fin contenido general-->
    </div>

    <!-- file reader url externo template html que va con el script del js-->
    <!--<script  src="https://code.jquery.com/jquery-2.2.4.min.js"   integrity="sha256-BbhdlvQf/xTY9gja0Dq3HiwQF8LaCRTXxZKRutelT44="   crossorigin="anonymous"></script>

        URL JSON o FILE:<input type="text" id="input-url" size="50" value=""></input>

        <input type="button" id="button" value="Ver .txt"></input>
        <div class="text">
        <hr />
        <h2>Texto:</h2> -->

    <!-- fin file reader url externo -->



</body>

</html>
